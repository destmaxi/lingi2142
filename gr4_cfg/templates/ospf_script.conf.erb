#!/bin/sh
######################################################################
#              Making Script Inter-routeur Ping                      #
######################################################################

DATE=`date '+%Y-%m-%d %H:%M:%S'`

echo "Output of OSPF check script launched on <%= @node_name %> at $DATE"

echo "################################################"

<%- if @id != 1 -%>

<%- @carn_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @carn %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to CARN on <%= @prefix_b %>:0004:<%= val %>::<%= @carn %>"
else
	echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @carn %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to CARN on <%= @prefix_a %>:0004:<%= val %>::<%= @carn %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>

<%- if @id != 2 -%>

<%- @hall_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @hall %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to HALL on <%= @prefix_b %>:0004:<%= val %>::<%= @hall %>"
else
        echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @hall %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to HALL on <%= @prefix_a %>:0004:<%= val %>::<%= @hall %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>


<%- if @id != 3 -%>

<%- @mich_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @mich %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to MICH on <%= @prefix_b %>:0004:<%= val %>::<%= @mich %>"
else
        echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @mich %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to MICH on <%= @prefix_a %>:0004:<%= val %>::<%= @mich %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>


<%- if @id != 4 -%>

<%- @pyth_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @pyth %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to PYTH on <%= @prefix_b %>:0004:<%= val %>::<%= @pyth %>"
else
        echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @pyth %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to PYTH on <%= @prefix_a %>:0004:<%= val %>::<%= @pyth %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>

<%- if @id != 5 -%>

<%- @sh1c_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @sh1c %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to SH1C on <%= @prefix_b %>:0004:<%= val %>::<%= @sh1c %>"
else
        echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @sh1c %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to SH1C on <%= @prefix_a %>:0004:<%= val %>::<%= @sh1c %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>

<%- if @id != 6 -%>

<%- @stev_link.each do |val| -%>

ping6 -q -c1 <%= @prefix_b %>:0004:<%= val %>::<%= @stev %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to STEV on <%= @prefix_b %>:0004:<%= val %>::<%= @stev %>"
else
        echo "OK"
fi

ping6 -q -c1 <%= @prefix_a %>:0004:<%= val %>::<%= @stev %> > /dev/null
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to STEV on <%= @prefix_a %>:0004:<%= val %>::<%= @stev %>"
else
        echo "OK"
fi

<%- end -%>
<%- end -%>

<%- if @id == 7 -%>

ping6 -q -c1 fd00:200:3:8888:: > /dev/null #ping to Google
if [ $? -ne 0 ]
then
        echo "Ping error from <%= @node_name %> to Google on fd00:200:3:8888::"
else
        echo "OK"
fi

<%- end -%>


echo "################################################"

